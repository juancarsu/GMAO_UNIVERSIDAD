{\rtf1\ansi\ansicpg1252\cocoartf2867
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 Menlo-Regular;}
{\colortbl;\red255\green255\blue255;\red42\green42\blue42;\red246\green247\blue249;\red20\green67\blue174;
\red46\green49\blue51;\red24\green25\blue27;\red162\green0\blue16;\red186\green6\blue115;\red18\green115\blue126;
\red77\green80\blue85;}
{\*\expandedcolortbl;;\cssrgb\c21961\c21961\c21961;\cssrgb\c97255\c97647\c98039;\cssrgb\c9412\c35294\c73725;
\cssrgb\c23529\c25098\c26275;\cssrgb\c12549\c12941\c14118;\cssrgb\c70196\c7843\c7059;\cssrgb\c78824\c15294\c52549;\cssrgb\c3529\c52157\c56863;
\cssrgb\c37255\c38824\c40784;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\partightenfactor0

\f0\fs26 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 <\cf4 \strokec4 script\cf2 \strokec2 >\cf5 \cb1 \strokec5 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3   \cf4 \strokec4 let\cf5 \strokec5  \cf6 \strokec6 currentContext\cf5 \strokec5  = \cf4 \strokec4 null\cf5 \strokec5 , \cf6 \strokec6 treeData\cf5 \strokec5  = [], \cf6 \strokec6 myChart\cf5 \strokec5  = \cf4 \strokec4 null\cf5 \strokec5 ;\cb1 \
\
\cb3   \cf6 \strokec6 window\cf5 \strokec5 .\cf6 \strokec6 onload\cf5 \strokec5  = \cf4 \strokec4 function\cf5 \strokec5 () \{ \cb1 \
\cb3     \cf6 \strokec6 loadTree\cf5 \strokec5 (); \cb1 \
\cb3     \cf6 \strokec6 loadDashboard\cf5 \strokec5 (); \cb1 \
\cb3   \};\cb1 \
\
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 loadTree\cf5 \strokec5 () \{\cb1 \
\cb3     \cf6 \strokec6 google\cf5 \strokec5 .\cf6 \strokec6 script\cf5 \strokec5 .\cf6 \strokec6 run\cf5 \strokec5 .\cf6 \strokec6 withSuccessHandler\cf5 \strokec5 (\cf6 \strokec6 data\cf5 \strokec5  => \{ \cf6 \strokec6 treeData\cf5 \strokec5  = \cf6 \strokec6 data\cf5 \strokec5 ; \cf6 \strokec6 renderTree\cf5 \strokec5 (\cf6 \strokec6 data\cf5 \strokec5 ); \}).\cf6 \strokec6 getArbolDatos\cf5 \strokec5 ();\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 loadDashboard\cf5 \strokec5 () \{\cb1 \
\cb3     \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'view-dashboard'\cf5 \strokec5 ).\cf6 \strokec6 classList\cf5 \strokec5 .\cf6 \strokec6 remove\cf5 \strokec5 (\cf7 \strokec7 'd-none'\cf5 \strokec5 );\cb1 \
\cb3     \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'view-details'\cf5 \strokec5 ).\cf6 \strokec6 classList\cf5 \strokec5 .\cf6 \strokec6 add\cf5 \strokec5 (\cf7 \strokec7 'd-none'\cf5 \strokec5 );\cb1 \
\cb3     \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 querySelectorAll\cf5 \strokec5 (\cf7 \strokec7 '.tree-item'\cf5 \strokec5 ).\cf6 \strokec6 forEach\cf5 \strokec5 (\cf6 \strokec6 d\cf5 \strokec5  => \cf6 \strokec6 d\cf5 \strokec5 .\cf6 \strokec6 classList\cf5 \strokec5 .\cf6 \strokec6 remove\cf5 \strokec5 (\cf7 \strokec7 'active-node'\cf5 \strokec5 ));\cb1 \
\
\cb3     \cf6 \strokec6 google\cf5 \strokec5 .\cf6 \strokec6 script\cf5 \strokec5 .\cf6 \strokec6 run\cf5 \strokec5 .\cf6 \strokec6 withSuccessHandler\cf5 \strokec5 (\cf6 \strokec6 data\cf5 \strokec5  => \{\cb1 \
\cb3       \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'dashActivos'\cf5 \strokec5 ).\cf6 \strokec6 innerText\cf5 \strokec5  = \cf6 \strokec6 data\cf5 \strokec5 .\cf6 \strokec6 activos\cf5 \strokec5 ;\cb1 \
\cb3       \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'dashVencidas'\cf5 \strokec5 ).\cf6 \strokec6 innerText\cf5 \strokec5  = \cf6 \strokec6 data\cf5 \strokec5 .\cf6 \strokec6 vencidas\cf5 \strokec5 ;\cb1 \
\cb3       \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'dashPendientes'\cf5 \strokec5 ).\cf6 \strokec6 innerText\cf5 \strokec5  = \cf6 \strokec6 data\cf5 \strokec5 .\cf6 \strokec6 pendientes\cf5 \strokec5 ;\cb1 \
\cb3       \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'dashContratos'\cf5 \strokec5 ).\cf6 \strokec6 innerText\cf5 \strokec5  = \cf6 \strokec6 data\cf5 \strokec5 .\cf6 \strokec6 contratosCaducados\cf5 \strokec5 ;\cb1 \
\
\cb3       \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 ctx\cf5 \strokec5  = \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'maintChart'\cf5 \strokec5 ).\cf6 \strokec6 getContext\cf5 \strokec5 (\cf7 \strokec7 '2d'\cf5 \strokec5 );\cb1 \
\cb3       \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 myChart\cf5 \strokec5 ) \cf6 \strokec6 myChart\cf5 \strokec5 .\cf6 \strokec6 destroy\cf5 \strokec5 (); \cb1 \
\cb3       \cf6 \strokec6 myChart\cf5 \strokec5  = \cf4 \strokec4 new\cf5 \strokec5  \cf8 \strokec8 Chart\cf5 \strokec5 (\cf6 \strokec6 ctx\cf5 \strokec5 , \{\cb1 \
\cb3         \cf6 \strokec6 type\cf5 \strokec5 : \cf7 \strokec7 'doughnut'\cf5 \strokec5 ,\cb1 \
\cb3         \cf6 \strokec6 data\cf5 \strokec5 : \{\cb1 \
\cb3           \cf6 \strokec6 labels\cf5 \strokec5 : [\cf7 \strokec7 'En Fecha'\cf5 \strokec5 , \cf7 \strokec7 'Pr\'f3ximas'\cf5 \strokec5 , \cf7 \strokec7 'Vencidas'\cf5 \strokec5 ],\cb1 \
\cb3           \cf6 \strokec6 datasets\cf5 \strokec5 : [\{\cb1 \
\cb3             \cf6 \strokec6 data\cf5 \strokec5 : [\cf6 \strokec6 data\cf5 \strokec5 .\cf6 \strokec6 ok\cf5 \strokec5 , \cf6 \strokec6 data\cf5 \strokec5 .\cf6 \strokec6 pendientes\cf5 \strokec5 , \cf6 \strokec6 data\cf5 \strokec5 .\cf6 \strokec6 vencidas\cf5 \strokec5 ],\cb1 \
\cb3             \cf6 \strokec6 backgroundColor\cf5 \strokec5 : [\cf7 \strokec7 '#198754'\cf5 \strokec5 , \cf7 \strokec7 '#ffc107'\cf5 \strokec5 , \cf7 \strokec7 '#dc3545'\cf5 \strokec5 ]\cb1 \
\cb3           \}]\cb1 \
\cb3         \},\cb1 \
\cb3         \cf6 \strokec6 options\cf5 \strokec5 : \{ \cf6 \strokec6 responsive\cf5 \strokec5 : \cf4 \strokec4 true\cf5 \strokec5 , \cf6 \strokec6 maintainAspectRatio\cf5 \strokec5 : \cf4 \strokec4 false\cf5 \strokec5  \}\cb1 \
\cb3       \});\cb1 \
\cb3     \}).\cf6 \strokec6 getDatosDashboard\cf5 \strokec5 ();\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 renderTree\cf5 \strokec5 (\cf6 \strokec6 data\cf5 \strokec5 ) \{\cb1 \
\cb3     \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 container\cf5 \strokec5  = \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'treeContainer'\cf5 \strokec5 );\cb1 \
\cb3     \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'loadingTree'\cf5 \strokec5 ).\cf6 \strokec6 classList\cf5 \strokec5 .\cf6 \strokec6 add\cf5 \strokec5 (\cf7 \strokec7 'd-none'\cf5 \strokec5 );\cb1 \
\cb3     \cf4 \strokec4 let\cf5 \strokec5  \cf6 \strokec6 html\cf5 \strokec5  = \cf7 \strokec7 ''\cf5 \strokec5 ;\cb1 \
\cb3     \cf6 \strokec6 data\cf5 \strokec5 .\cf6 \strokec6 forEach\cf5 \strokec5 (\cf6 \strokec6 c\cf5 \strokec5  => \{\cb1 \
\cb3       \cf6 \strokec6 html\cf5 \strokec5  += \cf6 \strokec6 createNodeHtml\cf5 \strokec5 (\cf6 \strokec6 c\cf5 \strokec5 , \cf7 \strokec7 'CAMPUS'\cf5 \strokec5 );\cb1 \
\cb3       \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 c\cf5 \strokec5 .\cf6 \strokec6 hijos\cf5 \strokec5 ?.\cf6 \strokec6 length\cf5 \strokec5 ) \{\cb1 \
\cb3          \cf6 \strokec6 html\cf5 \strokec5  += \cf7 \strokec7 `<div id="grp-\cf5 \strokec5 $\{\cf6 \strokec6 c\cf5 \strokec5 .\cf6 \strokec6 id\cf5 \strokec5 \}\cf7 \strokec7 " class="child-group">`\cf5 \strokec5 ;\cb1 \
\cb3          \cf6 \strokec6 c\cf5 \strokec5 .\cf6 \strokec6 hijos\cf5 \strokec5 .\cf6 \strokec6 forEach\cf5 \strokec5 (\cf6 \strokec6 e\cf5 \strokec5  => \{\cb1 \
\cb3             \cf6 \strokec6 html\cf5 \strokec5  += \cf6 \strokec6 createNodeHtml\cf5 \strokec5 (\cf6 \strokec6 e\cf5 \strokec5 , \cf7 \strokec7 'EDIFICIO'\cf5 \strokec5 );\cb1 \
\cb3             \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 e\cf5 \strokec5 .\cf6 \strokec6 hijos\cf5 \strokec5 ?.\cf6 \strokec6 length\cf5 \strokec5 ) \{\cb1 \
\cb3                \cf6 \strokec6 html\cf5 \strokec5  += \cf7 \strokec7 `<div id="grp-\cf5 \strokec5 $\{\cf6 \strokec6 e\cf5 \strokec5 .\cf6 \strokec6 id\cf5 \strokec5 \}\cf7 \strokec7 " class="child-group">`\cf5 \strokec5 ;\cb1 \
\cb3                \cf6 \strokec6 e\cf5 \strokec5 .\cf6 \strokec6 hijos\cf5 \strokec5 .\cf6 \strokec6 forEach\cf5 \strokec5 (\cf6 \strokec6 a\cf5 \strokec5  => \{ \cf6 \strokec6 html\cf5 \strokec5  += \cf6 \strokec6 createNodeHtml\cf5 \strokec5 (\cf6 \strokec6 a\cf5 \strokec5 , \cf7 \strokec7 'ACTIVO'\cf5 \strokec5 ); \});\cb1 \
\cb3                \cf6 \strokec6 html\cf5 \strokec5  += \cf7 \strokec7 `</div>`\cf5 \strokec5 ;\cb1 \
\cb3             \}\cb1 \
\cb3          \});\cb1 \
\cb3          \cf6 \strokec6 html\cf5 \strokec5  += \cf7 \strokec7 `</div>`\cf5 \strokec5 ;\cb1 \
\cb3       \}\cb1 \
\cb3     \});\cb1 \
\cb3     \cf6 \strokec6 container\cf5 \strokec5 .\cf6 \strokec6 innerHTML\cf5 \strokec5  = \cf6 \strokec6 html\cf5 \strokec5 ;\cb1 \
\cb3   \}\cb1 \
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 createNodeHtml\cf5 \strokec5 (\cf6 \strokec6 item\cf5 \strokec5 , \cf6 \strokec6 type\cf5 \strokec5 ) \{\cb1 \
\cb3     \cf4 \strokec4 let\cf5 \strokec5  \cf6 \strokec6 icon\cf5 \strokec5  = (\cf6 \strokec6 type\cf5 \strokec5  === \cf7 \strokec7 'EDIFICIO'\cf5 \strokec5 ) ? \cf7 \strokec7 'bi-house-door'\cf5 \strokec5  : (\cf6 \strokec6 type\cf5 \strokec5  === \cf7 \strokec7 'ACTIVO'\cf5 \strokec5 ) ? \cf7 \strokec7 'bi-gear'\cf5 \strokec5  : \cf7 \strokec7 'bi-building'\cf5 \strokec5 ;\cb1 \
\cb3     \cf4 \strokec4 return\cf5 \strokec5  \cf7 \strokec7 `<div class="tree-item" onclick="selectNode('\cf5 \strokec5 $\{\cf6 \strokec6 item\cf5 \strokec5 .\cf6 \strokec6 id\cf5 \strokec5 \}\cf7 \strokec7 ', '\cf5 \strokec5 $\{\cf6 \strokec6 type\cf5 \strokec5 \}\cf7 \strokec7 ', '\cf5 \strokec5 $\{\cf6 \strokec6 item\cf5 \strokec5 .\cf6 \strokec6 nombre\cf5 \strokec5 \}\cf7 \strokec7 ', this)"><i class="bi \cf5 \strokec5 $\{\cf6 \strokec6 icon\cf5 \strokec5 \}\cf7 \strokec7  me-1"></i> \cf5 \strokec5 $\{\cf6 \strokec6 item\cf5 \strokec5 .\cf6 \strokec6 nombre\cf5 \strokec5 \}$\{(\cf6 \strokec6 type\cf5 \strokec5  !== \cf7 \strokec7 'ACTIVO'\cf5 \strokec5 ) ? \cf7 \strokec7 `<i class="bi bi-caret-down-fill float-end small text-muted" onclick="toggleGroup('\cf5 \strokec5 $\{\cf6 \strokec6 item\cf5 \strokec5 .\cf6 \strokec6 id\cf5 \strokec5 \}\cf7 \strokec7 ', event)"></i>`\cf5 \strokec5  : \cf7 \strokec7 ''\cf5 \strokec5 \}\cf7 \strokec7 </div>`\cf5 \strokec5 ;\cb1 \
\cb3   \}\cb1 \
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 toggleGroup\cf5 \strokec5 (\cf6 \strokec6 id\cf5 \strokec5 , \cf6 \strokec6 e\cf5 \strokec5 ) \{ \cf6 \strokec6 e\cf5 \strokec5 .\cf6 \strokec6 stopPropagation\cf5 \strokec5 (); \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 el\cf5 \strokec5  = \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'grp-'\cf5 \strokec5  + \cf6 \strokec6 id\cf5 \strokec5 ); \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 el\cf5 \strokec5 ) \cf6 \strokec6 el\cf5 \strokec5 .\cf6 \strokec6 style\cf5 \strokec5 .\cf6 \strokec6 display\cf5 \strokec5  = (\cf6 \strokec6 el\cf5 \strokec5 .\cf6 \strokec6 style\cf5 \strokec5 .\cf6 \strokec6 display\cf5 \strokec5  === \cf7 \strokec7 'block'\cf5 \strokec5 ) ? \cf7 \strokec7 'none'\cf5 \strokec5  : \cf7 \strokec7 'block'\cf5 \strokec5 ; \}\cb1 \
\cb3   \cb1 \
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 selectNode\cf5 \strokec5 (\cf6 \strokec6 id\cf5 \strokec5 , \cf6 \strokec6 type\cf5 \strokec5 , \cf6 \strokec6 name\cf5 \strokec5 , \cf6 \strokec6 el\cf5 \strokec5 ) \{\cb1 \
\cb3     \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'view-dashboard'\cf5 \strokec5 ).\cf6 \strokec6 classList\cf5 \strokec5 .\cf6 \strokec6 add\cf5 \strokec5 (\cf7 \strokec7 'd-none'\cf5 \strokec5 );\cb1 \
\cb3     \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'view-details'\cf5 \strokec5 ).\cf6 \strokec6 classList\cf5 \strokec5 .\cf6 \strokec6 remove\cf5 \strokec5 (\cf7 \strokec7 'd-none'\cf5 \strokec5 );\cb1 \
\cb3     \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 querySelectorAll\cf5 \strokec5 (\cf7 \strokec7 '.tree-item'\cf5 \strokec5 ).\cf6 \strokec6 forEach\cf5 \strokec5 (\cf6 \strokec6 d\cf5 \strokec5  => \cf6 \strokec6 d\cf5 \strokec5 .\cf6 \strokec6 classList\cf5 \strokec5 .\cf6 \strokec6 remove\cf5 \strokec5 (\cf7 \strokec7 'active-node'\cf5 \strokec5 ));\cb1 \
\cb3     \cf6 \strokec6 el\cf5 \strokec5 .\cf6 \strokec6 classList\cf5 \strokec5 .\cf6 \strokec6 add\cf5 \strokec5 (\cf7 \strokec7 'active-node'\cf5 \strokec5 );\cb1 \
\cb3     \cf6 \strokec6 currentContext\cf5 \strokec5  = \{ \cf6 \strokec6 id\cf5 \strokec5 , \cf6 \strokec6 type\cf5 \strokec5 , \cf6 \strokec6 name\cf5 \strokec5  \};\cb1 \
\cb3     \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'ctxTitle'\cf5 \strokec5 ).\cf6 \strokec6 innerText\cf5 \strokec5  = \cf7 \strokec7 `\cf5 \strokec5 $\{\cf6 \strokec6 type\cf5 \strokec5 \}\cf7 \strokec7 : \cf5 \strokec5 $\{\cf6 \strokec6 name\cf5 \strokec5 \}\cf7 \strokec7 `\cf5 \strokec5 ;\cb1 \
\cb3     \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'mainTabs'\cf5 \strokec5 ).\cf6 \strokec6 classList\cf5 \strokec5 .\cf6 \strokec6 remove\cf5 \strokec5 (\cf7 \strokec7 'd-none'\cf5 \strokec5 );\cb1 \
\cb3     \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'tabContent'\cf5 \strokec5 ).\cf6 \strokec6 classList\cf5 \strokec5 .\cf6 \strokec6 remove\cf5 \strokec5 (\cf7 \strokec7 'd-none'\cf5 \strokec5 );\cb1 \
\cb3     \cb1 \
\cb3     \cf4 \strokec4 let\cf5 \strokec5  \cf6 \strokec6 actions\cf5 \strokec5  = \cf7 \strokec7 ''\cf5 \strokec5 ;\cb1 \
\cb3     \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 type\cf5 \strokec5  === \cf7 \strokec7 'CAMPUS'\cf5 \strokec5 ) \cf6 \strokec6 actions\cf5 \strokec5  = \cf7 \strokec7 `<button class="btn btn-sm btn-outline-primary" onclick="mostrarModalCrear('EDIFICIO')">+ Edificio</button>`\cf5 \strokec5 ;\cb1 \
\cb3     \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 type\cf5 \strokec5  === \cf7 \strokec7 'EDIFICIO'\cf5 \strokec5 ) \cf6 \strokec6 actions\cf5 \strokec5  = \cf7 \strokec7 `<button class="btn btn-sm btn-outline-primary" onclick="mostrarModalCrear('ACTIVO')">+ Activo</button>`\cf5 \strokec5 ;\cb1 \
\cb3     \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'ctxActions'\cf5 \strokec5 ).\cf6 \strokec6 innerHTML\cf5 \strokec5  = \cf6 \strokec6 actions\cf5 \strokec5 ;\cb1 \
\
\cb3     \cf6 \strokec6 switchTab\cf5 \strokec5 (\cf7 \strokec7 'info'\cf5 \strokec5 , \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 querySelector\cf5 \strokec5 (\cf7 \strokec7 '.nav-link.active'\cf5 \strokec5 ));\cb1 \
\cb3     \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 tabs\cf5 \strokec5  = \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 querySelectorAll\cf5 \strokec5 (\cf7 \strokec7 '.nav-link'\cf5 \strokec5 );\cb1 \
\cb3     \cf6 \strokec6 tabs\cf5 \strokec5 [\cf9 \strokec9 2\cf5 \strokec5 ].\cf6 \strokec6 style\cf5 \strokec5 .\cf6 \strokec6 display\cf5 \strokec5  = (\cf6 \strokec6 type\cf5 \strokec5  === \cf7 \strokec7 'ACTIVO'\cf5 \strokec5 ) ? \cf7 \strokec7 'block'\cf5 \strokec5  : \cf7 \strokec7 'none'\cf5 \strokec5 ;\cb1 \
\cb3     \cf6 \strokec6 tabs\cf5 \strokec5 [\cf9 \strokec9 3\cf5 \strokec5 ].\cf6 \strokec6 style\cf5 \strokec5 .\cf6 \strokec6 display\cf5 \strokec5  = (\cf6 \strokec6 type\cf5 \strokec5  === \cf7 \strokec7 'ACTIVO'\cf5 \strokec5  || \cf6 \strokec6 type\cf5 \strokec5  === \cf7 \strokec7 'EDIFICIO'\cf5 \strokec5 ) ? \cf7 \strokec7 'block'\cf5 \strokec5  : \cf7 \strokec7 'none'\cf5 \strokec5 ;\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 switchTab\cf5 \strokec5 (\cf6 \strokec6 tabId\cf5 \strokec5 , \cf6 \strokec6 navEl\cf5 \strokec5 ) \{\cb1 \
\cb3     \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 querySelectorAll\cf5 \strokec5 (\cf7 \strokec7 '.nav-link'\cf5 \strokec5 ).\cf6 \strokec6 forEach\cf5 \strokec5 (\cf6 \strokec6 l\cf5 \strokec5  => \cf6 \strokec6 l\cf5 \strokec5 .\cf6 \strokec6 classList\cf5 \strokec5 .\cf6 \strokec6 remove\cf5 \strokec5 (\cf7 \strokec7 'active'\cf5 \strokec5 ));\cb1 \
\cb3     \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 navEl\cf5 \strokec5 ) \cf6 \strokec6 navEl\cf5 \strokec5 .\cf6 \strokec6 classList\cf5 \strokec5 .\cf6 \strokec6 add\cf5 \strokec5 (\cf7 \strokec7 'active'\cf5 \strokec5 );\cb1 \
\cb3     [\cf7 \strokec7 'info'\cf5 \strokec5 , \cf7 \strokec7 'docs'\cf5 \strokec5 , \cf7 \strokec7 'maint'\cf5 \strokec5 , \cf7 \strokec7 'contracts'\cf5 \strokec5 ].\cf6 \strokec6 forEach\cf5 \strokec5 (\cf6 \strokec6 t\cf5 \strokec5  => \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 `view-\cf5 \strokec5 $\{\cf6 \strokec6 t\cf5 \strokec5 \}\cf7 \strokec7 `\cf5 \strokec5 ).\cf6 \strokec6 classList\cf5 \strokec5 .\cf6 \strokec6 add\cf5 \strokec5 (\cf7 \strokec7 'd-none'\cf5 \strokec5 ));\cb1 \
\cb3     \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 `view-\cf5 \strokec5 $\{\cf6 \strokec6 tabId\cf5 \strokec5 \}\cf7 \strokec7 `\cf5 \strokec5 ).\cf6 \strokec6 classList\cf5 \strokec5 .\cf6 \strokec6 remove\cf5 \strokec5 (\cf7 \strokec7 'd-none'\cf5 \strokec5 );\cb1 \
\cb3     \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 tabId\cf5 \strokec5  === \cf7 \strokec7 'docs'\cf5 \strokec5 ) \cf6 \strokec6 loadDocs\cf5 \strokec5 ();\cb1 \
\cb3     \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 tabId\cf5 \strokec5  === \cf7 \strokec7 'maint'\cf5 \strokec5  && \cf6 \strokec6 currentContext\cf5 \strokec5 .\cf6 \strokec6 type\cf5 \strokec5  === \cf7 \strokec7 'ACTIVO'\cf5 \strokec5 ) \cf6 \strokec6 loadMaint\cf5 \strokec5 ();\cb1 \
\cb3     \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 tabId\cf5 \strokec5  === \cf7 \strokec7 'contracts'\cf5 \strokec5 ) \cf6 \strokec6 loadContracts\cf5 \strokec5 ();\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf10 \strokec10 // --- MODALES ---\cf5 \cb1 \strokec5 \
\cb3   \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 maintModal\cf5 \strokec5  = \cf4 \strokec4 new\cf5 \strokec5  \cf6 \strokec6 bootstrap\cf5 \strokec5 .\cf8 \strokec8 Modal\cf5 \strokec5 (\cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'maintModal'\cf5 \strokec5 ));\cb1 \
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 mostrarModalRevision\cf5 \strokec5 () \{ \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'revTipo'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 =\cf7 \strokec7 ''\cf5 \strokec5 ; \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'revFecha'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 =\cf7 \strokec7 ''\cf5 \strokec5 ; \cf6 \strokec6 maintModal\cf5 \strokec5 .\cf6 \strokec6 show\cf5 \strokec5 (); \}\cb1 \
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 submitRevision\cf5 \strokec5 () \{ \cf6 \strokec6 google\cf5 \strokec5 .\cf6 \strokec6 script\cf5 \strokec5 .\cf6 \strokec6 run\cf5 \strokec5 .\cf6 \strokec6 withSuccessHandler\cf5 \strokec5 (\cf6 \strokec6 res\cf5 \strokec5  => \{ \cf6 \strokec6 maintModal\cf5 \strokec5 .\cf6 \strokec6 hide\cf5 \strokec5 (); \cf6 \strokec6 loadMaint\cf5 \strokec5 (); \}).\cf6 \strokec6 crearRevision\cf5 \strokec5 (\{\cf6 \strokec6 idActivo\cf5 \strokec5 : \cf6 \strokec6 currentContext\cf5 \strokec5 .\cf6 \strokec6 id\cf5 \strokec5 , \cf6 \strokec6 tipo\cf5 \strokec5 : \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'revTipo'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 , \cf6 \strokec6 fechaProx\cf5 \strokec5 : \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'revFecha'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 \}); \}\cb1 \
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 loadMaint\cf5 \strokec5 () \{\cb1 \
\cb3     \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 tbody\cf5 \strokec5  = \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'maintTableBody'\cf5 \strokec5 ); \cf6 \strokec6 tbody\cf5 \strokec5 .\cf6 \strokec6 innerHTML\cf5 \strokec5  = \cf7 \strokec7 '<tr><td colspan="4">Cargando...</td></tr>'\cf5 \strokec5 ;\cb1 \
\cb3     \cf6 \strokec6 google\cf5 \strokec5 .\cf6 \strokec6 script\cf5 \strokec5 .\cf6 \strokec6 run\cf5 \strokec5 .\cf6 \strokec6 withSuccessHandler\cf5 \strokec5 (\cf6 \strokec6 planes\cf5 \strokec5  => \{\cb1 \
\cb3       \cf4 \strokec4 if\cf5 \strokec5 (!\cf6 \strokec6 planes\cf5 \strokec5 .\cf6 \strokec6 length\cf5 \strokec5 ) \{ \cf6 \strokec6 tbody\cf5 \strokec5 .\cf6 \strokec6 innerHTML\cf5 \strokec5  = \cf7 \strokec7 '<tr><td colspan="4">Sin revisiones</td></tr>'\cf5 \strokec5 ; \cf4 \strokec4 return\cf5 \strokec5 ; \}\cb1 \
\cb3       \cf4 \strokec4 let\cf5 \strokec5  \cf6 \strokec6 html\cf5 \strokec5  = \cf7 \strokec7 ''\cf5 \strokec5 ;\cb1 \
\cb3       \cf6 \strokec6 planes\cf5 \strokec5 .\cf6 \strokec6 forEach\cf5 \strokec5 (\cf6 \strokec6 p\cf5 \strokec5  => \{\cb1 \
\cb3         \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 diff\cf5 \strokec5  = \cf8 \strokec8 Math\cf5 \strokec5 .\cf6 \strokec6 ceil\cf5 \strokec5 ((\cf4 \strokec4 new\cf5 \strokec5  \cf8 \strokec8 Date\cf5 \strokec5 (\cf6 \strokec6 p\cf5 \strokec5 .\cf6 \strokec6 fechaProxima\cf5 \strokec5 ) - \cf4 \strokec4 new\cf5 \strokec5  \cf8 \strokec8 Date\cf5 \strokec5 ()) / \cf9 \strokec9 86400000\cf5 \strokec5 );\cb1 \
\cb3         \cf4 \strokec4 let\cf5 \strokec5  \cf6 \strokec6 c\cf5 \strokec5  = (\cf6 \strokec6 diff\cf5 \strokec5  < \cf9 \strokec9 0\cf5 \strokec5 ) ? \cf7 \strokec7 'bg-rojo'\cf5 \strokec5  : (\cf6 \strokec6 diff\cf5 \strokec5  <= \cf9 \strokec9 30\cf5 \strokec5 ) ? \cf7 \strokec7 'bg-amarillo'\cf5 \strokec5  : \cf7 \strokec7 'bg-verde'\cf5 \strokec5 ;\cb1 \
\cb3         \cf6 \strokec6 html\cf5 \strokec5  += \cf7 \strokec7 `<tr><td class="text-center"><span class="dot \cf5 \strokec5 $\{\cf6 \strokec6 c\cf5 \strokec5 \}\cf7 \strokec7 "></span></td><td>\cf5 \strokec5 $\{\cf6 \strokec6 p\cf5 \strokec5 .\cf6 \strokec6 tipo\cf5 \strokec5 \}\cf7 \strokec7 </td><td>\cf5 \strokec5 $\{\cf6 \strokec6 p\cf5 \strokec5 .\cf6 \strokec6 fechaProxima\cf5 \strokec5 \}\cf7 \strokec7 </td><td><button class="btn btn-sm btn-light">Editar</button></td></tr>`\cf5 \strokec5 ;\cb1 \
\cb3       \});\cb1 \
\cb3       \cf6 \strokec6 tbody\cf5 \strokec5 .\cf6 \strokec6 innerHTML\cf5 \strokec5  = \cf6 \strokec6 html\cf5 \strokec5 ;\cb1 \
\cb3     \}).\cf6 \strokec6 obtenerPlanMantenimiento\cf5 \strokec5 (\cf6 \strokec6 currentContext\cf5 \strokec5 .\cf6 \strokec6 id\cf5 \strokec5 );\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 contractModal\cf5 \strokec5  = \cf4 \strokec4 new\cf5 \strokec5  \cf6 \strokec6 bootstrap\cf5 \strokec5 .\cf8 \strokec8 Modal\cf5 \strokec5 (\cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'contractModal'\cf5 \strokec5 ));\cb1 \
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 mostrarModalContrato\cf5 \strokec5 () \{ [\cf7 \strokec7 'contProv'\cf5 \strokec5 , \cf7 \strokec7 'contRef'\cf5 \strokec5 , \cf7 \strokec7 'contIni'\cf5 \strokec5 , \cf7 \strokec7 'contFin'\cf5 \strokec5 ].\cf6 \strokec6 forEach\cf5 \strokec5 (\cf6 \strokec6 id\cf5 \strokec5  => \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf6 \strokec6 id\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5  = \cf7 \strokec7 ''\cf5 \strokec5 ); \cf6 \strokec6 contractModal\cf5 \strokec5 .\cf6 \strokec6 show\cf5 \strokec5 (); \}\cb1 \
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 submitContract\cf5 \strokec5 () \{ \cf6 \strokec6 google\cf5 \strokec5 .\cf6 \strokec6 script\cf5 \strokec5 .\cf6 \strokec6 run\cf5 \strokec5 .\cf6 \strokec6 withSuccessHandler\cf5 \strokec5 (\cf6 \strokec6 res\cf5 \strokec5  => \{ \cf6 \strokec6 contractModal\cf5 \strokec5 .\cf6 \strokec6 hide\cf5 \strokec5 (); \cf6 \strokec6 loadContracts\cf5 \strokec5 (); \}).\cf6 \strokec6 crearContrato\cf5 \strokec5 (\{\cf6 \strokec6 idEntidad\cf5 \strokec5 : \cf6 \strokec6 currentContext\cf5 \strokec5 .\cf6 \strokec6 id\cf5 \strokec5 , \cf6 \strokec6 tipoEntidad\cf5 \strokec5 : \cf6 \strokec6 currentContext\cf5 \strokec5 .\cf6 \strokec6 type\cf5 \strokec5 , \cf6 \strokec6 proveedor\cf5 \strokec5 : \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'contProv'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 , \cf6 \strokec6 ref\cf5 \strokec5 : \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'contRef'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 , \cf6 \strokec6 fechaIni\cf5 \strokec5 : \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'contIni'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 , \cf6 \strokec6 fechaFin\cf5 \strokec5 : \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'contFin'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 \}); \}\cb1 \
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 loadContracts\cf5 \strokec5 () \{\cb1 \
\cb3     \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 tbody\cf5 \strokec5  = \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'contractsTableBody'\cf5 \strokec5 ); \cf6 \strokec6 tbody\cf5 \strokec5 .\cf6 \strokec6 innerHTML\cf5 \strokec5  = \cf7 \strokec7 '<tr><td colspan="4">Cargando...</td></tr>'\cf5 \strokec5 ;\cb1 \
\cb3     \cf6 \strokec6 google\cf5 \strokec5 .\cf6 \strokec6 script\cf5 \strokec5 .\cf6 \strokec6 run\cf5 \strokec5 .\cf6 \strokec6 withSuccessHandler\cf5 \strokec5 (\cf6 \strokec6 list\cf5 \strokec5  => \{\cb1 \
\cb3       \cf4 \strokec4 if\cf5 \strokec5 (!\cf6 \strokec6 list\cf5 \strokec5 .\cf6 \strokec6 length\cf5 \strokec5 ) \{ \cf6 \strokec6 tbody\cf5 \strokec5 .\cf6 \strokec6 innerHTML\cf5 \strokec5  = \cf7 \strokec7 '<tr><td colspan="4">Sin contratos</td></tr>'\cf5 \strokec5 ; \cf4 \strokec4 return\cf5 \strokec5 ; \}\cb1 \
\cb3       \cf4 \strokec4 let\cf5 \strokec5  \cf6 \strokec6 html\cf5 \strokec5  = \cf7 \strokec7 ''\cf5 \strokec5 ; \cf6 \strokec6 list\cf5 \strokec5 .\cf6 \strokec6 forEach\cf5 \strokec5 (\cf6 \strokec6 c\cf5 \strokec5  => \{ \cf6 \strokec6 html\cf5 \strokec5  += \cf7 \strokec7 `<tr><td><span class="badge badge-\cf5 \strokec5 $\{\cf6 \strokec6 c\cf5 \strokec5 .\cf6 \strokec6 color\cf5 \strokec5 \}\cf7 \strokec7 ">\cf5 \strokec5 $\{\cf6 \strokec6 c\cf5 \strokec5 .\cf6 \strokec6 estado\cf5 \strokec5 \}\cf7 \strokec7 </span></td><td>\cf5 \strokec5 $\{\cf6 \strokec6 c\cf5 \strokec5 .\cf6 \strokec6 proveedor\cf5 \strokec5 \}\cf7 \strokec7 </td><td>\cf5 \strokec5 $\{\cf6 \strokec6 c\cf5 \strokec5 .\cf6 \strokec6 ref\cf5 \strokec5 \}\cf7 \strokec7 </td><td><small>\cf5 \strokec5 $\{\cf6 \strokec6 c\cf5 \strokec5 .\cf6 \strokec6 inicio\cf5 \strokec5 \}\cf7 \strokec7  - \cf5 \strokec5 $\{\cf6 \strokec6 c\cf5 \strokec5 .\cf6 \strokec6 fin\cf5 \strokec5 \}\cf7 \strokec7 </small></td></tr>`\cf5 \strokec5 ; \});\cb1 \
\cb3       \cf6 \strokec6 tbody\cf5 \strokec5 .\cf6 \strokec6 innerHTML\cf5 \strokec5  = \cf6 \strokec6 html\cf5 \strokec5 ;\cb1 \
\cb3     \}).\cf6 \strokec6 obtenerContratos\cf5 \strokec5 (\cf6 \strokec6 currentContext\cf5 \strokec5 .\cf6 \strokec6 id\cf5 \strokec5 );\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 uploadFile\cf5 \strokec5 () \{\cb1 \
\cb3     \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 file\cf5 \strokec5  = \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'fileInput'\cf5 \strokec5 ).\cf6 \strokec6 files\cf5 \strokec5 [\cf9 \strokec9 0\cf5 \strokec5 ];\cb1 \
\cb3     \cf4 \strokec4 if\cf5 \strokec5 (!\cf6 \strokec6 file\cf5 \strokec5  || \cf6 \strokec6 file\cf5 \strokec5 .\cf6 \strokec6 size\cf5 \strokec5  > \cf9 \strokec9 8388608\cf5 \strokec5 ) \cf4 \strokec4 return\cf5 \strokec5  \cf6 \strokec6 alert\cf5 \strokec5 (\cf7 \strokec7 "Error archivo"\cf5 \strokec5 );\cb1 \
\cb3     \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 btn\cf5 \strokec5 =\cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 querySelector\cf5 \strokec5 (\cf7 \strokec7 '#view-docs button'\cf5 \strokec5 ), \cf6 \strokec6 st\cf5 \strokec5 =\cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'uploadStatus'\cf5 \strokec5 );\cb1 \
\cb3     \cf6 \strokec6 btn\cf5 \strokec5 .\cf6 \strokec6 disabled\cf5 \strokec5 =\cf4 \strokec4 true\cf5 \strokec5 ; \cf6 \strokec6 st\cf5 \strokec5 .\cf6 \strokec6 innerText\cf5 \strokec5 =\cf7 \strokec7 'Subiendo...'\cf5 \strokec5 ;\cb1 \
\cb3     \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 r\cf5 \strokec5  = \cf4 \strokec4 new\cf5 \strokec5  \cf8 \strokec8 FileReader\cf5 \strokec5 (); \cf6 \strokec6 r\cf5 \strokec5 .\cf6 \strokec6 onload\cf5 \strokec5 =\cf4 \strokec4 function\cf5 \strokec5 (\cf6 \strokec6 e\cf5 \strokec5 )\{ \cf6 \strokec6 google\cf5 \strokec5 .\cf6 \strokec6 script\cf5 \strokec5 .\cf6 \strokec6 run\cf5 \strokec5 .\cf6 \strokec6 withSuccessHandler\cf5 \strokec5 (\cf6 \strokec6 res\cf5 \strokec5 =>\{ \cf6 \strokec6 btn\cf5 \strokec5 .\cf6 \strokec6 disabled\cf5 \strokec5 =\cf4 \strokec4 false\cf5 \strokec5 ; \cf6 \strokec6 st\cf5 \strokec5 .\cf6 \strokec6 innerText\cf5 \strokec5 =\cf7 \strokec7 'OK'\cf5 \strokec5 ; \cf6 \strokec6 loadDocs\cf5 \strokec5 (); \}).\cf6 \strokec6 subirArchivo\cf5 \strokec5 (\cf6 \strokec6 e\cf5 \strokec5 .\cf6 \strokec6 target\cf5 \strokec5 .\cf6 \strokec6 result\cf5 \strokec5 .\cf6 \strokec6 split\cf5 \strokec5 (\cf7 \strokec7 ','\cf5 \strokec5 )[\cf9 \strokec9 1\cf5 \strokec5 ], \cf6 \strokec6 file\cf5 \strokec5 .\cf6 \strokec6 name\cf5 \strokec5 , \cf6 \strokec6 file\cf5 \strokec5 .\cf6 \strokec6 type\cf5 \strokec5 , \cf6 \strokec6 currentContext\cf5 \strokec5 .\cf6 \strokec6 id\cf5 \strokec5 , \cf6 \strokec6 currentContext\cf5 \strokec5 .\cf6 \strokec6 type\cf5 \strokec5 ); \}; \cf6 \strokec6 r\cf5 \strokec5 .\cf6 \strokec6 readAsDataURL\cf5 \strokec5 (\cf6 \strokec6 file\cf5 \strokec5 );\cb1 \
\cb3   \}\cb1 \
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 loadDocs\cf5 \strokec5 () \{\cb1 \
\cb3     \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 tbody\cf5 \strokec5  = \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'docsTableBody'\cf5 \strokec5 ); \cf6 \strokec6 tbody\cf5 \strokec5 .\cf6 \strokec6 innerHTML\cf5 \strokec5  = \cf7 \strokec7 '<tr><td colspan="4">Cargando...</td></tr>'\cf5 \strokec5 ;\cb1 \
\cb3     \cf6 \strokec6 google\cf5 \strokec5 .\cf6 \strokec6 script\cf5 \strokec5 .\cf6 \strokec6 run\cf5 \strokec5 .\cf6 \strokec6 withSuccessHandler\cf5 \strokec5 (\cf6 \strokec6 docs\cf5 \strokec5  => \{\cb1 \
\cb3       \cf4 \strokec4 if\cf5 \strokec5 (!\cf6 \strokec6 docs\cf5 \strokec5 .\cf6 \strokec6 length\cf5 \strokec5 ) \{ \cf6 \strokec6 tbody\cf5 \strokec5 .\cf6 \strokec6 innerHTML\cf5 \strokec5  = \cf7 \strokec7 '<tr><td colspan="4">Sin documentos</td></tr>'\cf5 \strokec5 ; \cf4 \strokec4 return\cf5 \strokec5 ; \}\cb1 \
\cb3       \cf4 \strokec4 let\cf5 \strokec5  \cf6 \strokec6 html\cf5 \strokec5  = \cf7 \strokec7 ''\cf5 \strokec5 ; \cf6 \strokec6 docs\cf5 \strokec5 .\cf6 \strokec6 forEach\cf5 \strokec5 (\cf6 \strokec6 d\cf5 \strokec5  => \{ \cf6 \strokec6 html\cf5 \strokec5  += \cf7 \strokec7 `<tr><td>\cf5 \strokec5 $\{\cf6 \strokec6 d\cf5 \strokec5 .\cf6 \strokec6 nombre\cf5 \strokec5 \}\cf7 \strokec7 </td><td>v\cf5 \strokec5 $\{\cf6 \strokec6 d\cf5 \strokec5 .\cf6 \strokec6 version\cf5 \strokec5 \}\cf7 \strokec7 </td><td>\cf5 \strokec5 $\{\cf6 \strokec6 d\cf5 \strokec5 .\cf6 \strokec6 fecha\cf5 \strokec5 \}\cf7 \strokec7 </td><td><a href="\cf5 \strokec5 $\{\cf6 \strokec6 d\cf5 \strokec5 .\cf6 \strokec6 url\cf5 \strokec5 \}\cf7 \strokec7 " target="_blank">Ver</a></td></tr>`\cf5 \strokec5 ; \});\cb1 \
\cb3       \cf6 \strokec6 tbody\cf5 \strokec5 .\cf6 \strokec6 innerHTML\cf5 \strokec5  = \cf6 \strokec6 html\cf5 \strokec5 ;\cb1 \
\cb3     \}).\cf6 \strokec6 obtenerDocs\cf5 \strokec5 (\cf6 \strokec6 currentContext\cf5 \strokec5 .\cf6 \strokec6 id\cf5 \strokec5 );\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 myModal\cf5 \strokec5  = \cf4 \strokec4 new\cf5 \strokec5  \cf6 \strokec6 bootstrap\cf5 \strokec5 .\cf8 \strokec8 Modal\cf5 \strokec5 (\cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'createModal'\cf5 \strokec5 ));\cb1 \
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 mostrarModalCrear\cf5 \strokec5 (\cf6 \strokec6 type\cf5 \strokec5 ) \{\cb1 \
\cb3     \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'createForm'\cf5 \strokec5 ).\cf6 \strokec6 reset\cf5 \strokec5 (); \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'modalType'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5  = \cf6 \strokec6 type\cf5 \strokec5 ; \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'modalTitle'\cf5 \strokec5 ).\cf6 \strokec6 innerText\cf5 \strokec5  = \cf7 \strokec7 'Crear '\cf5 \strokec5  + \cf6 \strokec6 type\cf5 \strokec5 ;\cb1 \
\cb3     \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 currentContext\cf5 \strokec5 ) \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'modalParentId'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5  = \cf6 \strokec6 currentContext\cf5 \strokec5 .\cf6 \strokec6 id\cf5 \strokec5 ;\cb1 \
\cb3     \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 ex\cf5 \strokec5  = \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'extraFields'\cf5 \strokec5 ); \cf6 \strokec6 ex\cf5 \strokec5 .\cf6 \strokec6 innerHTML\cf5 \strokec5  = \cf7 \strokec7 ''\cf5 \strokec5 ;\cb1 \
\cb3     \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 type\cf5 \strokec5  === \cf7 \strokec7 'CAMPUS'\cf5 \strokec5 ) \cf6 \strokec6 ex\cf5 \strokec5 .\cf6 \strokec6 innerHTML\cf5 \strokec5  = \cf7 \strokec7 `<div class="mb-2"><label>Provincia</label><input id="fProv" class="form-control"></div><div class="mb-2"><label>Direcci\'f3n</label><input id="fDir" class="form-control"></div>`\cf5 \strokec5 ;\cb1 \
\cb3     \cf4 \strokec4 else\cf5 \strokec5  \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 type\cf5 \strokec5  === \cf7 \strokec7 'EDIFICIO'\cf5 \strokec5 ) \cf6 \strokec6 ex\cf5 \strokec5 .\cf6 \strokec6 innerHTML\cf5 \strokec5  = \cf7 \strokec7 `<div class="mb-2"><label>Contacto</label><input id="fCont" class="form-control"></div>`\cf5 \strokec5 ;\cb1 \
\cb3     \cf4 \strokec4 else\cf5 \strokec5  \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 type\cf5 \strokec5  === \cf7 \strokec7 'ACTIVO'\cf5 \strokec5 ) \{\cb1 \
\cb3        \cf6 \strokec6 ex\cf5 \strokec5 .\cf6 \strokec6 innerHTML\cf5 \strokec5  = \cf7 \strokec7 `<div class="mb-2"><label>Tipo</label><select id="fTipo" class="form-select" disabled><option>Cargando...</option></select></div><div class="mb-2"><label>Marca</label><input id="fMarca" class="form-control"></div>`\cf5 \strokec5 ;\cb1 \
\cb3        \cf6 \strokec6 google\cf5 \strokec5 .\cf6 \strokec6 script\cf5 \strokec5 .\cf6 \strokec6 run\cf5 \strokec5 .\cf6 \strokec6 withSuccessHandler\cf5 \strokec5 (\cf6 \strokec6 ts\cf5 \strokec5  => \{ \cf4 \strokec4 let\cf5 \strokec5  \cf6 \strokec6 o\cf5 \strokec5 =\cf7 \strokec7 '<option value="">Sel...</option>'\cf5 \strokec5 ; \cf6 \strokec6 ts\cf5 \strokec5 .\cf6 \strokec6 forEach\cf5 \strokec5 (\cf6 \strokec6 t\cf5 \strokec5 =>\{\cf6 \strokec6 o\cf5 \strokec5 +=\cf7 \strokec7 `<option value="\cf5 \strokec5 $\{\cf6 \strokec6 t\cf5 \strokec5 .\cf6 \strokec6 id\cf5 \strokec5 \}\cf7 \strokec7 ">\cf5 \strokec5 $\{\cf6 \strokec6 t\cf5 \strokec5 .\cf6 \strokec6 nombre\cf5 \strokec5 \}\cf7 \strokec7 </option>`\cf5 \strokec5 \}); \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'fTipo'\cf5 \strokec5 ).\cf6 \strokec6 innerHTML\cf5 \strokec5 =\cf6 \strokec6 o\cf5 \strokec5 ; \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'fTipo'\cf5 \strokec5 ).\cf6 \strokec6 disabled\cf5 \strokec5 =\cf4 \strokec4 false\cf5 \strokec5 ; \}).\cf6 \strokec6 getCatalogoInstalaciones\cf5 \strokec5 ();\cb1 \
\cb3     \}\cb1 \
\cb3     \cf6 \strokec6 myModal\cf5 \strokec5 .\cf6 \strokec6 show\cf5 \strokec5 ();\cb1 \
\cb3   \}\cb1 \
\cb3   \cb1 \
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 submitCreate\cf5 \strokec5 () \{\cb1 \
\cb3     \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 t\cf5 \strokec5 =\cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'modalType'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 , \cf6 \strokec6 p\cf5 \strokec5 =\cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'modalParentId'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 , \cf6 \strokec6 n\cf5 \strokec5 =\cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'fNombre'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 ;\cb1 \
\cb3     \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 btn\cf5 \strokec5  = \cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 querySelector\cf5 \strokec5 (\cf7 \strokec7 '#createModal .btn-primary'\cf5 \strokec5 );\cb1 \
\cb3     \cf6 \strokec6 btn\cf5 \strokec5 .\cf6 \strokec6 disabled\cf5 \strokec5  = \cf4 \strokec4 true\cf5 \strokec5 ; \cf6 \strokec6 btn\cf5 \strokec5 .\cf6 \strokec6 innerText\cf5 \strokec5  = \cf7 \strokec7 "Guardando..."\cf5 \strokec5 ;\cb1 \
\cb3     \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 handler\cf5 \strokec5  = (\cf6 \strokec6 res\cf5 \strokec5 ) => \{ \cf6 \strokec6 btn\cf5 \strokec5 .\cf6 \strokec6 disabled\cf5 \strokec5  = \cf4 \strokec4 false\cf5 \strokec5 ; \cf6 \strokec6 btn\cf5 \strokec5 .\cf6 \strokec6 innerText\cf5 \strokec5  = \cf7 \strokec7 "Guardar"\cf5 \strokec5 ; \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 res\cf5 \strokec5 .\cf6 \strokec6 success\cf5 \strokec5 ) \{ \cf6 \strokec6 myModal\cf5 \strokec5 .\cf6 \strokec6 hide\cf5 \strokec5 (); \cf6 \strokec6 loadTree\cf5 \strokec5 (); \} \cf4 \strokec4 else\cf5 \strokec5  \{ \cf6 \strokec6 alert\cf5 \strokec5 (\cf7 \strokec7 "Error: "\cf5 \strokec5  + \cf6 \strokec6 res\cf5 \strokec5 .\cf6 \strokec6 error\cf5 \strokec5 ); \} \};\cb1 \
\
\cb3     \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 t\cf5 \strokec5 ===\cf7 \strokec7 'CAMPUS'\cf5 \strokec5 ) \cf6 \strokec6 google\cf5 \strokec5 .\cf6 \strokec6 script\cf5 \strokec5 .\cf6 \strokec6 run\cf5 \strokec5 .\cf6 \strokec6 withSuccessHandler\cf5 \strokec5 (\cf6 \strokec6 handler\cf5 \strokec5 ).\cf6 \strokec6 crearCampus\cf5 \strokec5 (\{\cf6 \strokec6 nombre\cf5 \strokec5 :\cf6 \strokec6 n\cf5 \strokec5 , \cf6 \strokec6 provincia\cf5 \strokec5 :\cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'fProv'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 , \cf6 \strokec6 direccion\cf5 \strokec5 :\cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'fDir'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 \});\cb1 \
\cb3     \cf4 \strokec4 else\cf5 \strokec5  \cf4 \strokec4 if\cf5 \strokec5 (\cf6 \strokec6 t\cf5 \strokec5 ===\cf7 \strokec7 'EDIFICIO'\cf5 \strokec5 ) \cf6 \strokec6 google\cf5 \strokec5 .\cf6 \strokec6 script\cf5 \strokec5 .\cf6 \strokec6 run\cf5 \strokec5 .\cf6 \strokec6 withSuccessHandler\cf5 \strokec5 (\cf6 \strokec6 handler\cf5 \strokec5 ).\cf6 \strokec6 crearEdificio\cf5 \strokec5 (\{\cf6 \strokec6 nombre\cf5 \strokec5 :\cf6 \strokec6 n\cf5 \strokec5 , \cf6 \strokec6 idCampus\cf5 \strokec5 :\cf6 \strokec6 p\cf5 \strokec5 , \cf6 \strokec6 contacto\cf5 \strokec5 :\cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'fCont'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 \});\cb1 \
\cb3     \cf4 \strokec4 else\cf5 \strokec5  \cf6 \strokec6 google\cf5 \strokec5 .\cf6 \strokec6 script\cf5 \strokec5 .\cf6 \strokec6 run\cf5 \strokec5 .\cf6 \strokec6 withSuccessHandler\cf5 \strokec5 (\cf6 \strokec6 handler\cf5 \strokec5 ).\cf6 \strokec6 crearActivo\cf5 \strokec5 (\{\cf6 \strokec6 nombre\cf5 \strokec5 :\cf6 \strokec6 n\cf5 \strokec5 , \cf6 \strokec6 idEdificio\cf5 \strokec5 :\cf6 \strokec6 p\cf5 \strokec5 , \cf6 \strokec6 tipo\cf5 \strokec5 :\cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'fTipo'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 , \cf6 \strokec6 marca\cf5 \strokec5 :\cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'fMarca'\cf5 \strokec5 ).\cf6 \strokec6 value\cf5 \strokec5 \});\cb1 \
\cb3   \}\cb1 \
\
\cb3   \cf4 \strokec4 const\cf5 \strokec5  \cf6 \strokec6 normModal\cf5 \strokec5  = \cf4 \strokec4 new\cf5 \strokec5  \cf6 \strokec6 bootstrap\cf5 \strokec5 .\cf8 \strokec8 Modal\cf5 \strokec5 (\cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'normativaModal'\cf5 \strokec5 ));\cb1 \
\cb3   \cf4 \strokec4 function\cf5 \strokec5  \cf6 \strokec6 mostrarModalNormativa\cf5 \strokec5 () \{ \cf6 \strokec6 normModal\cf5 \strokec5 .\cf6 \strokec6 show\cf5 \strokec5 (); \cf6 \strokec6 google\cf5 \strokec5 .\cf6 \strokec6 script\cf5 \strokec5 .\cf6 \strokec6 run\cf5 \strokec5 .\cf6 \strokec6 withSuccessHandler\cf5 \strokec5 (\cf6 \strokec6 l\cf5 \strokec5 =>\{\cf4 \strokec4 let\cf5 \strokec5  \cf6 \strokec6 h\cf5 \strokec5 =\cf7 \strokec7 ''\cf5 \strokec5 ;\cf6 \strokec6 l\cf5 \strokec5 .\cf6 \strokec6 forEach\cf5 \strokec5 (\cf6 \strokec6 i\cf5 \strokec5 =>\{\cf6 \strokec6 h\cf5 \strokec5 +=\cf7 \strokec7 `<tr><td>\cf5 \strokec5 $\{\cf6 \strokec6 i\cf5 \strokec5 .\cf6 \strokec6 nombre\cf5 \strokec5 \}\cf7 \strokec7 </td><td>\cf5 \strokec5 $\{\cf6 \strokec6 i\cf5 \strokec5 .\cf6 \strokec6 norma\cf5 \strokec5 \}\cf7 \strokec7 </td><td>\cf5 \strokec5 $\{\cf6 \strokec6 i\cf5 \strokec5 .\cf6 \strokec6 dias\cf5 \strokec5 \}\cf7 \strokec7 </td></tr>`\cf5 \strokec5 \});\cf6 \strokec6 document\cf5 \strokec5 .\cf6 \strokec6 getElementById\cf5 \strokec5 (\cf7 \strokec7 'tablaNormativaBody'\cf5 \strokec5 ).\cf6 \strokec6 innerHTML\cf5 \strokec5 =\cf6 \strokec6 h\cf5 \strokec5 ;\}).\cf6 \strokec6 getCatalogoInstalaciones\cf5 \strokec5 (); \}\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 </\cf4 \strokec4 script\cf2 \strokec2 >\cf5 \cb1 \strokec5 \
}